## 10.17汉字俄罗斯方块题目

```
/**
 * Q、服务端保存汉字和偏旁的数据结构，并如何验证汉字组合正确？请用编码实现
 * 分两部分：
 * 1、服务端输出接口，比如客户端读取接口，服务端下发什么样的数据结构给前端？
 * 2、客户端上传接口，客户端上传什么样的数据结构给服务端，用来服务端验证？
 * 说明：
 * 1、参照上图游戏规则，设计服务端下发接口契约和客户端验证数据契约（需要实现具体拆解实例和验证过程），核心就是服务端字怎么拆，客户端怎么合并，最后怎么验证合并的是否正确。
 * 2、 限定一个字 最多只能分三块， 上中下， 左中右，或者如图所示 蠢字 上下下， 或者下上上，还有霸上左下右下等。形式不限。
 * 3、汉字示例：双、夸、蠢、从、鹏、朋、森、林、好、孙、骑、霸
 * 4、并非是需要罗列所有汉字，而是总结出汉字拆解和合并的规律
 * 5、给出前端要展示的偏旁部首
 */
```

## 解答

### step1：服务端接收中文列表，post调用中文拆字接口，返回拆字结果并保存在服务端

post调用中文拆字接口地址：

```
http://www.atoolbox.net/Api/GetChineseCharacterDismantling.php
```

post调用中文拆字接口请求 ("multipart/form-data")：

```
ch: 双霸
tf: jt
```

post调用中文拆字接口返回：

```json
{
    "code":200,
    "msg":"OK",
    "data":[
        {
            "letter":"双",
            "radicals":"又 又\n"
        },
        {
            "letter":"霸",
            "radicals":"雨 革 月\n"
        }
    ]
}
```

保存在服务端的数据为chineseToStrokeMap和strokeToChineseMap：

```json
{
    "chineseToStrokeMap":{
        "双":[
            "又",
            "又"
        ],
        "霸":[
            "雨",
            "革",
            "月"
        ]
    },
    "strokeToChineseMap":{
        "又又":"双",
        "雨革月":"霸"
    }
}
```

### step2：服务端下发数据结构给客户端

根据chineseToStrokeMap组装数据，服务端发给客户端的数据如下：

备注：为了方便客户端匹配，这里的偏旁部首是服务端逆序之后发给客户端的，即strokeList是逆序之后的结果，供客户端消费

```json
{
    "strokeList":[
        "月",
        "革",
        "雨",
        "又",
        "又"
    ],
    "wordList":[
        [
            "又",
            "又"
        ],
        [
            "雨",
            "革",
            "月"
        ]
    ]
}
```

### step3：客户端顺序消费，并放置服务端发送的strokeList

备注：

- 假定客户端为3*3的棋盘

- 使用二维数组posList，为客户端接收的每个元素指定放置的位置

  即："月"放置在棋盘的第三行第二列，“革”放置在第三行第一列... ...

```
int[][] posList = {{2, 1}, {2, 0}, {1, 0}, {2, 1}, {2, 0}};
```

### step4：每次放置好元素后，客户端尝试匹配合并汉字（待合并汉字为wordList中的元素）

客户端放置好元素后，对于wordList的每个待合并汉字，使用dfs深度优先遍历匹配算法进行匹配：

- 以当前放置元素位置为起点，使用dfs深度优先遍历，判断是否能找到与wordList中的元素完全相同的路径，若能则匹配成功。不再匹配。

- 若匹配成功，记录匹配路径，并将路径中的元素，按照坐标进行顺时针排序，得到的即为客户端匹配汉字。

举例图示如下：

|      |      |      |
| ---- | ---- | ---- |
| 雨   |      |      |
| 革   | 月   |      |

[具体算法参考：LeetCode79-word-search](https://leetcode.com/problems/word-search/)

### step5：服务端校验通过，匹配成功，客户端清除匹配结果

服务端通过判断客户端的匹配结果是否在map中，校验客户端的匹配结果

```
this.strokeToChineseMap.getOrDefault(request.getMatchResult(), null);
```



## 时间复杂度分析

### 客户端每次进行中文匹配的时间复杂度

假设服务端有k个中文字，中文字最大不超过t个偏旁部首，三个方向遍历，客户端的棋盘格为：m*n

1.若服务端按倒序的顺序发放偏旁部首：

客户端每次进行中文匹配的时间复杂度：k*4**(t-1)

 2.若服务端按乱序的顺序发放偏旁部首：

客户端每次进行中文匹配的时间复杂度：m×n×k*4**(t-1)

### 服务端校验的时间复杂度

服务端校验的时间复杂度：o(1)

